// Form handling, typewriter effect, and other interactions combined and optimized
document.addEventListener("DOMContentLoaded", function () {
  // Form handling
  const form=document.getElementById("contactForm");
  if(form){
      const t=form.querySelector("button[type='submit']"),
      n=t.querySelector(".spinner-border"),
      o=t.querySelector(".submit-text"),
      l=document.getElementById("successAlert"),
      d=document.getElementById("errorAlert");
      
      form.addEventListener("submit",async e=>{
          try{
              if(e.preventDefault(),
              o.textContent="Sending...",
              n.classList.remove("d-none"),
              t.disabled=true,
              !form.checkValidity()) throw new Error("Form invalid");
              
              const a=new FormData(form);
              const c=await fetch(form.action,{
                  method:"POST",
                  body:a,
                  headers:{Accept:"application/json"}
              });
              c.ok?(l.classList.remove("d-none"),d.classList.add("d-none"),form.reset()):
              (l.classList.add("d-none"),d.classList.remove("d-none"))
          }catch(e){
              console.error(e),
              l.classList.add("d-none"),
              d.classList.remove("d-none")
          }finally{
              o.textContent="Send Message",
              n.classList.add("d-none"),
              t.disabled=false
          }
      });
    }
    
  const c = [
      "Enterprise Architect",
      "Cloud Native Expert",
      "AI Solutions Developer",
      "Technical Leader",
      "Senior Software Engineer",
    ],
    s = 200,
    i = 100,
    r = 2e3;
  let u = 0,
    m = 0;
  function f() {
    m < c[u].length
      ? ((document.querySelector(".typed-text").textContent += c[u].charAt(m)),
        m++,
        setTimeout(f, s))
      : setTimeout(h, r);
  }
  function h() {
    m > 0
      ? ((document.querySelector(".typed-text").textContent = c[u].substring(
          0,
          m - 1
        )),
        m--,
        setTimeout(h, i))
      : (u++, u >= c.length && (u = 0), setTimeout(f, s + 1100));
  }
  c.length && setTimeout(f, r + 250);
});
